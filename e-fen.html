<html>
<head>
<title>Expanded FEN (E-FEN) Specification</title>
</head>
<body>
<h1>Expanded FEN (E-FEN) Specification</h1>
<p>This document proposes <em>E-FEN</em>, a superset of FEN, X-FEN, and Shredder FEN.

<h2>Precursors</h2>
<p><a href="http://en.wikipedia.org/wiki/FEN">Forsyth-Edwards Notation</a> was invented by David Forsyth (1854-1909), and later extended by Steven J. Edwards for computer use. FEN contains six fields which record the state of a chess game, including board position, castling possibilities, active color, and so on. White pieces are represented by uppercase letters, black pieces by lowercase. For example, in FEN notation the starting position of a standard chess game is:
<pre>rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1</pre>

<p><a href="http://en.wikipedia.org/wiki/X-FEN">X-FEN</a> (aka FRC-FEN) extends FEN in several ways to support:
<ul>
<li><a href="http://en.wikipedia.org/wiki/Chess960">Chess960 (Fischer Random Chess, FRC)</a>
<li><a href="http://en.wikipedia.org/wiki/Chess960#Chess480">Chess480</a>
<li><a href="http://en.wikipedia.org/wiki/Capablanca_chess">Capablanca chess</a>
<li><a href="http://en.wikipedia.org/wiki/Capablanca_random_chess">Capablanca Random Chess (CRC)</a>
<li><a href="http://en.wikipedia.org/wiki/Gothic_chess">Gothic Chess</a>
<li><a href="http://en.wikipedia.org/wiki/Embassy_Chess">Embassy Chess</a>
<li><a href="http://en.wikipedia.org/wiki/Janus_Chess">Janus chess</a>
<li><a href="http://en.wikipedia.org/wiki/Grand_chess">Grand chess</a> - 10x10 board
<li>... and perhaps more(?)
</ul>

<p>Notably, X-FEN allows an 8x10 board, adds support for encoding archbishop/janus/cardinal (knight + bishop) and chancellor/empress/marshall (knight + rook), in addition to extending castling possibilities indicated by the KQkq notation.

<p>Shredder-FEN is similar, but uses the starting file of the rook for indicating castle privileges (for regular chess, AHah would be used for full castling privileges instead of KQkq).

<h2>Piece Types</h2>
<p>E-FEN primarily extends the "board positon" portion of FEN, to allow for a large variety of 
<a href="http://en.wikipedia.org/wiki/Fairy_chess_piece">fairy chess pieces</a>

<p>The assigned letters and canonical piece names are are described below. Due to their
decentralized development, mythical chess pieces have many conflicting or synonymous names.
E-FEN standardizes on the names below. Piece movement is given in <em>Extended Parlett</em>. A
piece's movement must be representable in Extended Parlett before having a letter assigned. Like FEN,
uppercase is for white, lowercase for black.

<p><a name="table"></a>
<table border="1">
 <tr>
  <th>Letter</th>
  <th>Source</th>
  <th>Name</th>
  <th>Movement</th>
</tr><tr>
  <td>A</td>
  <td>X-FEN</td>
  <td>Archbishop</th>
  <td>nX, ~1/2</td>
 </tr><tr>
  <td>B</td>
  <td>FEN</td>
  <td>Bishop</td>
  <td>nX</td>
 </tr><tr>
  <td>C</td>
  <td>X-FEN</td>
  <td>Chancellor</td>
  <td>n+, ~1/2</td>
 </tr><tr>
  <td>D</td>
  <td></td>
  <td>Dababba</td>
  <td>~2/0</td>
 </tr><tr>
  <td>E</td>
  <td></td>
  <td>Elephant</td>
  <td>2X</td>
 </tr><tr>
  <td>F</td>
  <td></td>
  <td>Frog</td>
  <td>~1/1, ~0/3</td>
 </tr><tr>
  <td>G</td>
  <td></td>
  <td>Giraffe</td>
  <td>~1/4</td>
 </tr><tr>
  <td>H</td>
  <td></td>
  <td>Threeleaper</td>
  <td>~3/0</td>
 </tr><tr>
  <td>I</td>
  <td></td>
  <td>Wazir</td>
  <td>1+</td>
 </tr><tr>
  <td>J</td>
  <td></td>
  <td>Squid</td>
  <td>o~n/m ~0/0</td>
 </tr><tr>
  <td>K</td>
  <td>FEN</td>
  <td>King</td>
  <td>1+</td>
 </tr><tr>
  <td>L</td>
  <td></td>
  <td>Alibaba</td>
  <td>~2/0, ~2X</td>
 </tr><tr>
  <td>M</td>
  <td></td>
  <td>Man</td>
  <td>1*</td>
 </tr><tr>
  <td>N</td>
  <td>FEN</td>
  <td>Knight</td>
  <td>~1/2</td>
 </tr><tr>
  <td>O</td>
  <td></td>
  <td>Zero</td>
  <td>~0/0</td>
 </tr><tr>
  <td>P</td>
  <td>FEN</td>
  <td>Pawn</td>
  <td>o1>, P, c1X>, oi2&gt;eE</td>
 </tr><tr>
  <td>Q</td>
  <td>FEN</td>
  <td>Queen</td>
  <td>n*</td>
 </tr><tr>
  <td>R</td>
  <td>FEN</td>
  <td>Rook</td>
  <td>n+</td>
 </tr><tr>
  <td>S</td>
  <td></td>
  <td>Squirrel</td>
  <td>~0/2, ~1/2, ~2/2</td>
 </tr><tr>
  <td>T</td>
  <td></td>
  <td>Tripper</td>
  <td>~3/3</td>
 </tr><tr>
  <td>U</td>
  <td></td>
  <td>Octopus</td>
  <td>o~n/m</td>
 </tr><tr>
  <td>V</td>
  <td></td>
  <td>Amazon</td>
  <td>n*, ~1/2</td>
 </tr><tr>
  <td>W</td>
  <td></td>
  <td>Camel</td>
  <td>~1/3</td>
 </tr><tr>
  <td>X</td>
  <td></td>
  <td><em>Extended code, see below</em></td>
  <td></td>
 </tr><tr>
  <td>Y</td>
  <td></td>
  <td>Alfil</td>
  <td>~2/2</td>
 </tr><tr>
  <td>Z</td>
  <td></td>
  <td>Zebra</td>
  <td>~2/3</td>
 </tr>
</table>

<p>The code "X" indicates an extended piece code. One or more characters follow. 

<p>
<table border="1">
 <tr>
  <th>Letter</th>
  <th>Source</th>
  <th>Name</th>
  <th>Movement</th>
 </tr><tr>
  <td>XA</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XB</td>
  <td></td>
  <td>Berolina pawn</td>
  <td>o1X&gt;, c1&gt;, io2X&gt;</td>
 </tr><tr>
  <td>XC</td>
  <td></td>
  <td>Colonel</td>
  <td>n&gt;, n=, 2/1&gt;, 1*</td>
 </tr><tr>
  <td>XD</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XE</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XF</td>
  <td></td>
  <td>Fers</td>
  <td>1X</td>
 </tr><tr>
  <td>XG</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XH</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XI</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XJ</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XK</td>
  <td></td>
  <td>Khohn</td>
  <td>1X, 1&gt;</td>
 </tr><tr>
  <td>XL</td>
  <td></td>
  <td>Lion</td>
  <td>~n*</td>
 </tr><tr>
  <td>XM</td>
  <td></td>
  <td>Murray lion</td>
  <td>~0/2, ~2/2, c1*</td>
 </tr><tr>
  <td>XN</td>
  <td></td>
  <td>Knightrider</td>
  <td>n(1/2)</td>
 </tr><tr>
  <td>XO</td>
  <td></td>
  <td>Leo</td>
  <td>on*, c^&</td>
 </tr><tr>
  <td>XP</td>
  <td></td>
  <td>Superpawn</td>
  <td>on&gt;, cnX&gt;</td>
 </tr><tr>
  <td>XQ</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XR</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XS</td>
  <td></td>
  <td>Spy</td>
  <td>2&gt;, 2=, (1/1)&gt;</td>
 </tr><tr>
  <td>XT</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XU</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XV</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XW</td>
  <td></td>
  <td></td>
  <td></td>
 </tr><tr>
  <td>XX</td>
  <td></td>
  <td><em>Extended code, see below</em></td>
  <td></td>
 </tr><tr>
  <td>XY</td>
  <td></td>
  <td>Checker</td>
  <td>cn(^2X&gt;), o1X&gt;</td>
 </tr><tr>
  <td>XZ</td>
  <td></td>
  <td>Kinged Checker</td>
  <td>cn(^2X), o1x</td>
 </tr>
</table>

<p>The X's can be extended indefinitely. Once XA-XZ are assigned, you can use XXA-XXZ, and then XXXA-XXXZ.

<p>A parenthesis after the initial X indicates a piece name follows, terminated by a closing parenthesis.
This allows for greater flexibility than assigning possibly obscure letter codes, if the pieces are even
more obscure. As a bad example, X(pawn) is a pawn. This would be most useful for custom designed pieces,
perhaps loaded from a file or other user data.

<p>The most verbose, but flexible notation is to enclose a |-separated key/value pair (denoted by =) of
the piece attributes in square brackets: X[image=king.gif|parlett=1*|royal=true]. This is to be used sparingly.

<h1>Extended Parlett</h1>
<p>Based on <a href="http://en.wikipedia.org/wiki/Fairy_chess_piece#Parlett.27s_movement_notation">Parlett movement notation</a>, with extensions
described on that page. Additionally:

<p>~n/m is a special token representing all squares on the board, except where the piece is currently at. For all squares everywhere, combine
with ~0/0 for ~n/m, ~0/0.

<!-- TODO: m for multi-move, to represent castling rooks? -->

<p>The "e" flag indicates that the piece can only move to the last square in the direction given, exactly not any less. For example, 2&gt;e means the piece must move exactly two squares forward, not one square, even though it is still a rider (cannot leap).

<p>"E" says to store the square behind where the piece moved, in a special global GAME_STATE.ep_target. This is used for pawn en passant moves. The two-move causes this variable to be updated, for example: oi2&gt;eE.

<p>"P", by itself, is a move to the en passant target square, as long as the pawn can diagonally move forwards towards it. See the pawn Parlett notation for an example. The pawn in front of the target square will be captured.

</table>
</body>
</html>
